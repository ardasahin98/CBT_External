<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial</title>
  <link rel="stylesheet" href="style.css" />
  <script src="script.js"></script>
</head>
<body>

<div class="tutorial-wrapper">

  <div class="question-header">
    <h1>Website Tutorial</h1>
    <p>Click the blue “i” icons to learn what each part does.</p>
  </div>

  <div class="tutorial-image-stack">

    <!-- IMAGE 1 -->
    <div class="tutorial-image-container" >
      <img src="Tutorial_Example.png" alt="Tutorial Example 1">

      <div class="hotspot-wrap" style="top:4%; left:25%;">
            <button class="tutorial-hotspot" type="button">i</button>
                <div class="tutorial-popover">
                <div class="popover-text">
                    Navigation buttons to go to first, previous, next and last questions. Your responses are saved when any of these button are pressed so you can complete the test with breaks.
                </div>
            </div>
      </div>

        <div class="hotspot-wrap" style="top:8%; left:44%;">
            <button class="tutorial-hotspot" type="button">i</button>
                <div class="tutorial-popover">
                <div class="popover-text">
                    Dropdown menu allowing you to select different cycles with certain strain levels including 3%, 4%, 5%, 6% strains and last cycle.
                </div>
            </div>
        </div>

        <div class="hotspot-wrap" style="top:15%; left:18%;">
            <button class="tutorial-hotspot" type="button">i</button>
                <div class="tutorial-popover">
                <div class="popover-text">
                    Plot showing shear strain (%) vs. shear stress (kPa) applied in the test. The gray ones are all of the cycles and the thick black one shows the cycle based on the selected strain level from the dropdown menu
                </div>
            </div>
        </div>

        <div class="hotspot-wrap" style="top:15%; right:15%;">
            <button class="tutorial-hotspot" type="button">i</button>
                <div class="tutorial-popover">
                <div class="popover-text">
                    Plot showing effective vertical stress normalized by initial effective vertical stress vs. shear stress normalized by initial effective vertical stress. The thick black one is based on the selected strain level from the dropdown menu
                </div>
            </div>
        </div>

        <div class="hotspot-wrap" style="top:40%; left:18%;">
            <button class="tutorial-hotspot" type="button">i</button>
                <div class="tutorial-popover">
                <div class="popover-text">
                    Plot showing shear strain (%) vs. time (s) during the test. The thick black one is based on the selected strain level from the dropdown menu
                </div>
            </div>
        </div>

         <div class="hotspot-wrap" style="top:40%; right:15%;">
            <button class="tutorial-hotspot" type="button">i</button>
                <div class="tutorial-popover">
                <div class="popover-text">
                    Plot showing effective vertical stress normalized by initial effective vertical stress vs. time (s) during the test. Also maximum pore pressure ratio is marked in the top y-axis. The thick black one is based on the selected strain level from the dropdown menu
                </div>
            </div>
        </div>

         <div class="hotspot-wrap" style="bottom:36%; left:39%;">
            <button class="tutorial-hotspot" type="button">i</button>
                <div class="tutorial-popover">
                <div class="popover-text">
                    This box shows general information regarding test including test type, shear strain for the cycle marked in all of the plots with thich black line, total number of cycles applied during the test and the cycle number of the marked one
                </div>
            </div>
        </div>

         <div class="hotspot-wrap" style="bottom:28%; left:20%;">
            <button class="tutorial-hotspot" type="button">i</button>
                <div class="tutorial-popover">
                <div class="popover-text">
                    This part of the website is for you to assign a cyclic behavior type as a Beta distribution. By changing the slider or current value, you can arrange the mean. Desired standard deviation can be assigned but it should noted that it is bounded by a maximum value due to its definition and this value is presented below the standard deviation text area. If you believe this test is not usable in any reason including but not limited to test being terminated immaturely and measurement errors, you can mark "Data is not usable" checkbox to indicate it. 
                </div>
            </div>
        </div>

         <div class="hotspot-wrap" style="bottom:28%; left:50%;">
            <button class="tutorial-hotspot" type="button">i</button>
                <div class="tutorial-popover">
                <div class="popover-text">
                    This part of the website allows you to visualize the Beta distribution based on the mean and standard deviation assigned at the left-hand side panel. It will be dynamically changing when mean and standard deviation values are updated
                </div>
            </div>
        </div>

         <div class="hotspot-wrap" style="bottom:28%; left:80%;">
            <button class="tutorial-hotspot" type="button">i</button>
                <div class="tutorial-popover">
                <div class="popover-text">
                    This part of the website allows you to leave any comments you have for the test. It can be used to justify the assigned mean and standard deviation or to explain why it is marked as not usable. This part will allow us to understand the way you are thinking during these assessments
                </div>
            </div>
        </div>

  </div>

  <div class="tutorial-actions">
    <button class="exit-tutorial-btn" type="button" onclick="exitTutorial()">
      Exit Tutorial
    </button>
  </div>

</div>

<script>document.addEventListener("DOMContentLoaded", () => {

  // ---------- Hotspot popovers ----------
  document.querySelectorAll(".tutorial-hotspot").forEach(btn => {
    btn.addEventListener("click", (e) => {
      e.stopPropagation();

      const wrap = btn.closest(".hotspot-wrap");
      const popover = btn.nextElementSibling;
      const container = btn.closest(".tutorial-image-container");

      const willOpen = !popover.classList.contains("open");

      // close all others first
      document.querySelectorAll(".tutorial-popover.open").forEach(p => {
        p.classList.remove("open");
        p.closest(".hotspot-wrap")?.classList.remove("active");
      });

      if (!willOpen) return;

      popover.classList.add("open");
      wrap.classList.add("active");

      // measure
      popover.style.visibility = "hidden";
      popover.style.display = "block";

      const containerRect = container.getBoundingClientRect();
      const btnRect = btn.getBoundingClientRect();

      const gap = 36;
      const pad = 10;
      const minW = 160;

      // ---------- horizontal ----------
      const maxRight = (containerRect.right - pad) - (btnRect.right + gap);
      const maxLeft  = (btnRect.left - gap) - (containerRect.left + pad);
      const openRight = maxRight >= minW || maxRight >= maxLeft;

      popover.style.left = openRight ? `${gap}px` : "auto";
      popover.style.right = openRight ? "auto" : `${gap}px`;
      popover.style.maxWidth =
        `${Math.max(minW, Math.floor(openRight ? maxRight : maxLeft))}px`;

      // ---------- vertical ----------
      popover.style.top = "0px";
      const popRect = popover.getBoundingClientRect();

      const overflowBottom = popRect.bottom - (containerRect.bottom - pad);
      const overflowTop = (containerRect.top + pad) - popRect.top;

      if (overflowBottom > 0) popover.style.top = `${-overflowBottom}px`;
      if (overflowTop > 0) popover.style.top = `${overflowTop}px`;

      popover.style.visibility = "visible";
      popover.style.display = "";
    });
  });

  // ---------- close when clicking anywhere else ----------
  document.addEventListener("click", () => {
    document.querySelectorAll(".tutorial-popover.open").forEach(p => {
      p.classList.remove("open");
      p.closest(".hotspot-wrap")?.classList.remove("active");
    });
  });

});
</script>

</body>
</html>